{% extends 'base.html.twig' %}

{% block title %}Liste des sondages{% endblock %}

{% block body %}
    <h1>Liste des sondages</h1>
    <p>
        <a href="{{ path('survey_edit', {'id': 0}) }}">Créer un nouveau sondage</a>
    </p>
    {% if surveys %}
        <table>
            <thead>
                <th scope="col">Titre du sondage</th>
                <th scope="col">Statut du sondage</th>
                <th scope="col">Date de création _ date de clôture</th>
                <th scope="col">Consulter</th>
                <th scope="col">Modifier</th>
                <th scope="col">Supprimer</th>
                <th scope="col">Résultats obtenus (nombre de participants au sondage)</th>
                <th scope="col">Gestion des réponses</th>
                <th scope="col">Version grand public</th>
            </thead>
            {% for survey in surveys %}
                <tr>
                    <th scope="row">{{ survey.title }}</th>
                    <td>{{ survey.status }}</td>
                    <td>
                        {{ survey.createdat|date("d/m/Y H:i") }}
                        {% if survey.status=="Fermé" %}
                           – {{ survey.closedat|date("d/m/Y H:i") }}
                        {% elseif survey.status=="Initialisé" %}
                            – En cours de création
                        {% elseif survey.status=="Ouvert" %}
                            – En cours de soumission
                        {% endif %}
                    </td>
                    <td><a href="{{ path('survey_show', {'id': survey.id}) }}">Voir</a></td>
                    <td><a href="{{ path('survey_edit', {'id': survey.id}) }}">Modifier</a></td>
                    <td><a href="{{ path('survey_delete', {'id': survey.id}) }}">Supprimer</a></td>
                    <td><a href="{{ path('survey_result', {'id': survey.id}) }}">Voir les résultats ({{ survey.answers|length }})</a></td>
                    <td><a href="{{ path('answer_list', {'id': survey.id}) }}">Gérer</a></td>
                    <td>
                        <a href="{{ path('answer_answer', {'id': survey.id}) }}">
                            Répondre
                        </a>
                    </td>                            
                </tr>
            {% endfor %}    
        </table>
    {% else %}
        <p>Aucun sondage créé.</p>
    {% endif %}
{% endblock %}